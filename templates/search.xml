<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Network Structure</title>
      <link href="/2026/01/11/Mechanics/NetworkStructure/"/>
      <url>/2026/01/11/Mechanics/NetworkStructure/</url>
      
        <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>I try to build a lightweight multiplayer networking framework by using <strong>Photon PUN’s free tier</strong>.</p><p>The source code is available on <a href="https://github.com/zong4/GameMechanics">GitHub</a>.</p><h1 id="Network-Manager"><a href="#Network-Manager" class="headerlink" title="Network Manager"></a>Network Manager</h1><p>Manage the connection to Photon server, room joining&#x2F;leaving, and scene loading.</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">NetworkManager</span> : <span class="title">MonoBehaviourPunCallbacks</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> NetworkManager _instance;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">bool</span> _isConnected = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">bool</span> _isRoomListUpdated = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> List&lt;RoomInfo&gt; _roomList;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Awake</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (_instance &amp;&amp; _instance != <span class="keyword">this</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Destroy(gameObject);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Singleton pattern</span></span><br><span class="line">        _instance = <span class="keyword">this</span>;</span><br><span class="line">        DontDestroyOnLoad(gameObject);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Connect to Photon server</span></span><br><span class="line">        PhotonNetwork.AutomaticallySyncScene = <span class="literal">true</span>;</span><br><span class="line">        PhotonNetwork.ConnectUsingSettings();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnConnectedToMaster</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Debug.Log(<span class="string">&quot;Connected to Master Server&quot;</span>);</span><br><span class="line">        PhotonNetwork.JoinLobby();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnJoinedLobby</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Debug.Log(<span class="string">&quot;Joined Lobby&quot;</span>);</span><br><span class="line">        _isConnected = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnJoinedRoom</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> room = PhotonNetwork.CurrentRoom;</span><br><span class="line">        Debug.Log(<span class="string">$&quot;Joined Room: <span class="subst">&#123;room.Name&#125;</span>&quot;</span>);</span><br><span class="line">        Debug.Log(<span class="string">$&quot;Players: <span class="subst">&#123;room.PlayerCount&#125;</span>/<span class="subst">&#123;room.MaxPlayers&#125;</span>&quot;</span>);</span><br><span class="line">        Debug.Log(<span class="string">$&quot;IsOpen: <span class="subst">&#123;room.IsOpen&#125;</span>, IsVisible: <span class="subst">&#123;room.IsVisible&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">        SceneManager.sceneLoaded += OnRoomSceneLoaded;</span><br><span class="line">        SceneManager.sceneLoaded += OnGameSceneLoaded;</span><br><span class="line">        PhotonNetwork.LoadLevel(<span class="string">&quot;Room&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnLeftRoom</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Debug.Log(<span class="string">&quot;Left Room&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (PhotonNetwork.IsConnected)</span><br><span class="line">            PhotonNetwork.Disconnect();</span><br><span class="line">        PhotonNetwork.LoadLevel(<span class="string">&quot;Menu&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnRoomListUpdate</span>(<span class="params">List&lt;RoomInfo&gt; roomList</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _roomList = roomList;</span><br><span class="line">        _isRoomListUpdated = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">OnRoomSceneLoaded</span>(<span class="params">Scene scene, LoadSceneMode mode</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (scene.name == <span class="string">&quot;Room&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            PhotonNetwork.Instantiate(<span class="string">&quot;Player&quot;</span>, Vector3.zero, Quaternion.identity);</span><br><span class="line">            SceneManager.sceneLoaded -= OnRoomSceneLoaded;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">OnGameSceneLoaded</span>(<span class="params">Scene scene, LoadSceneMode mode</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (scene.name == <span class="string">&quot;Game&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            PhotonNetwork.Instantiate(<span class="string">&quot;Player&quot;</span>, Vector3.zero, Quaternion.identity);</span><br><span class="line">            SceneManager.sceneLoaded -= OnGameSceneLoaded;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Lobby"><a href="#Lobby" class="headerlink" title="Lobby"></a>Lobby</h1><p><img src="/img/Mechanics/NetworkStructure/Lobby.png"></p><p>Script will hide&#x2F;show certain UI elements based on connection status.</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Lobby</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;GameObject&gt; waitingConnectedObjects;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">bool</span> _isConnected = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Awake</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Disable connected objects until connected to Photon server</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> obj <span class="keyword">in</span> waitingConnectedObjects)</span><br><span class="line">            obj.SetActive(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Update</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (Input.GetKeyDown(KeyCode.Escape))</span><br><span class="line">            SceneManager.LoadScene(<span class="string">&quot;Menu&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Enable connected objects</span></span><br><span class="line">        <span class="keyword">if</span> (!_isConnected &amp;&amp; NetworkManager.Instance().IsConnected())</span><br><span class="line">        &#123;</span><br><span class="line">            _isConnected = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> obj <span class="keyword">in</span> waitingConnectedObjects)</span><br><span class="line">                obj.SetActive(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Host-x2F-Join-Room"><a href="#Host-x2F-Join-Room" class="headerlink" title="Host &#x2F; Join Room"></a>Host &#x2F; Join Room</h1><p>Host &#x2F; Join room with options provided by Photon PUN.</p><ul><li><input disabled="" type="checkbox"> Add password protection feature.</li></ul><p><img src="/img/Mechanics/NetworkStructure/CreateRoom.png"></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HostRoom</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> TMP_InputField roomNameInputField;</span><br><span class="line">    <span class="keyword">public</span> List&lt;Toggle&gt; maxPlayersToggles;</span><br><span class="line">    <span class="keyword">public</span> Toggle visibleToggle;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnHostButtonClicked</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(roomNameInputField.text))</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> maxPlayers = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> toggle <span class="keyword">in</span> maxPlayersToggles)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (toggle.isOn)</span><br><span class="line">            &#123;</span><br><span class="line">                maxPlayers = <span class="built_in">int</span>.Parse(toggle.name);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> isVisible = visibleToggle.isOn;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> roomOptions = <span class="keyword">new</span> Photon.Realtime.RoomOptions</span><br><span class="line">        &#123;</span><br><span class="line">            MaxPlayers = maxPlayers,</span><br><span class="line">            IsVisible = isVisible,</span><br><span class="line">            IsOpen = <span class="literal">true</span></span><br><span class="line">        &#125;;</span><br><span class="line">        PhotonNetwork.CreateRoom(roomNameInputField.text, roomOptions);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/img/Mechanics/NetworkStructure/JoinRoom.png"></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">JoinRoom</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> GameObject roomEntryPrefab;</span><br><span class="line">    <span class="keyword">public</span> Transform roomListContent;</span><br><span class="line">    <span class="keyword">public</span> TMP_InputField roomNameInputField;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> Dictionary&lt;<span class="built_in">string</span>, GameObject&gt; _roomEntries = <span class="keyword">new</span>();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Update</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (Input.GetKeyDown(KeyCode.Escape))</span><br><span class="line">            PhotonNetwork.LoadLevel(<span class="string">&quot;Lobby&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!NetworkManager.Instance().IsRoomListUpdated() &amp;&amp; _roomEntries.Count &gt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Delete old entries</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> entry <span class="keyword">in</span> _roomEntries.Values)</span><br><span class="line">            Destroy(entry);</span><br><span class="line">        _roomEntries.Clear();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> roomInfo <span class="keyword">in</span> NetworkManager.Instance().RoomList())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (roomInfo.RemovedFromList)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Only show open rooms with available slots</span></span><br><span class="line">            <span class="keyword">if</span> (!roomInfo.IsOpen || roomInfo.PlayerCount &gt;= roomInfo.MaxPlayers)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> entryObj = Instantiate(roomEntryPrefab, roomListContent);</span><br><span class="line">            _roomEntries[roomInfo.Name] = entryObj;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Set room info text</span></span><br><span class="line">            <span class="keyword">var</span> text = entryObj.GetComponentInChildren&lt;TMP_Text&gt;();</span><br><span class="line">            text.text = <span class="string">$&quot;Room: <span class="subst">&#123;roomInfo.Name&#125;</span>   &quot;</span> +</span><br><span class="line">                        <span class="string">$&quot;Players: <span class="subst">&#123;roomInfo.PlayerCount&#125;</span>/<span class="subst">&#123;roomInfo.MaxPlayers&#125;</span>&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Set button click listener</span></span><br><span class="line">            <span class="keyword">var</span> button = entryObj.GetComponent&lt;Button&gt;();</span><br><span class="line">            <span class="keyword">var</span> capturedName = roomInfo.Name;</span><br><span class="line">            button.onClick.AddListener(() =&gt; &#123; roomNameInputField.text = capturedName; &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnJoinButtonClicked</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(roomNameInputField.text))</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        PhotonNetwork.JoinRoom(roomNameInputField.text);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Room"><a href="#Room" class="headerlink" title="Room"></a>Room</h1><p>Players are waiting in the room until all are ready.</p><ul><li><input disabled="" type="checkbox"> Players can wait in different rooms(like matchmaking) before starting the game.</li></ul><p><img src="/img/Mechanics/NetworkStructure/Room.png"></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Room</span> : <span class="title">MonoBehaviourPunCallbacks</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> Button readyButton;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">bool</span> _isReady = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="built_in">string</span> PlayerReadyKey = <span class="string">&quot;Ready&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Awake</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        UpdateReadyButtonText();</span><br><span class="line">        readyButton.onClick.AddListener(OnReadyButtonClicked);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Update</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (Input.GetKeyDown(KeyCode.Escape))</span><br><span class="line">            PhotonNetwork.LeaveRoom();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnReadyButtonClicked</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        _isReady = !_isReady;</span><br><span class="line">        UpdateReadyButtonText();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> props = <span class="keyword">new</span> Hashtable</span><br><span class="line">        &#123;</span><br><span class="line">            &#123; PlayerReadyKey, _isReady &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        PhotonNetwork.LocalPlayer.SetCustomProperties(props);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">UpdateReadyButtonText</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        readyButton.GetComponentInChildren&lt;TMP_Text&gt;().text =</span><br><span class="line">            _isReady ? <span class="string">&quot;Unready&quot;</span> : <span class="string">&quot;Ready&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnPlayerPropertiesUpdate</span>(<span class="params">Photon.Realtime.Player player, Hashtable changedProps</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!changedProps.ContainsKey(PlayerReadyKey))</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (PhotonNetwork.IsMasterClient)</span><br><span class="line">            TryStartGame();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TryStartGame</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// check if all players are ready</span></span><br><span class="line">        <span class="keyword">var</span> readyPlayers = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> player <span class="keyword">in</span> PhotonNetwork.PlayerList)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!player.CustomProperties.TryGetValue(PlayerReadyKey, <span class="keyword">out</span> <span class="keyword">var</span> readyObj))</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">if</span> (!(<span class="built_in">bool</span>)readyObj)</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">            readyPlayers++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (readyPlayers == PhotonNetwork.CurrentRoom.MaxPlayers)</span><br><span class="line">            PhotonNetwork.LoadLevel(<span class="string">&quot;Game&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Game"><a href="#Game" class="headerlink" title="Game"></a>Game</h1><p>Players will keep some status from the room, e.g., appearance(color).</p><p><img src="/img/Mechanics/NetworkStructure/Game.png"></p><p>Use Photon custom properties to sync player appearance.</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Appearance</span> : <span class="title">MonoBehaviourPunCallbacks</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> SpriteRenderer _spriteRenderer;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">const</span> <span class="built_in">string</span> PlayerColorKey = <span class="string">&quot;Color&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Awake</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        _spriteRenderer = GetComponent&lt;SpriteRenderer&gt;();</span><br><span class="line">        <span class="keyword">if</span> (photonView.Owner.CustomProperties.TryGetValue(PlayerColorKey, <span class="keyword">out</span> <span class="keyword">var</span> colorObj))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// Retrieve and apply the color from custom properties</span></span><br><span class="line">            <span class="keyword">var</span> rgb = (<span class="built_in">float</span>[])colorObj;</span><br><span class="line">            _spriteRenderer.color = <span class="keyword">new</span> Color(rgb[<span class="number">0</span>], rgb[<span class="number">1</span>], rgb[<span class="number">2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// Default color if none is set</span></span><br><span class="line">            _spriteRenderer.color = Color.white;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Update</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!photonView.IsMine)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (SceneManager.GetActiveScene().name == <span class="string">&quot;Game&quot;</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (Input.GetKeyDown(KeyCode.Alpha1)) SetColor(Color.red);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (Input.GetKeyDown(KeyCode.Alpha2)) SetColor(Color.green);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (Input.GetKeyDown(KeyCode.Alpha3)) SetColor(Color.blue);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (Input.GetKeyDown(KeyCode.Alpha4)) SetColor(Color.yellow);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">SetColor</span>(<span class="params">Color color</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _spriteRenderer.color = color;</span><br><span class="line">        <span class="keyword">var</span> rgb = <span class="keyword">new</span>[] &#123; color.r, color.g, color.b &#125;;</span><br><span class="line">        <span class="keyword">var</span> props = <span class="keyword">new</span> Hashtable</span><br><span class="line">        &#123;</span><br><span class="line">            &#123; PlayerColorKey, rgb &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        PhotonNetwork.LocalPlayer.SetCustomProperties(props);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnPlayerPropertiesUpdate</span>(<span class="params">Photon.Realtime.Player targetPlayer, Hashtable changedProps</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (changedProps.ContainsKey(PlayerColorKey))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (photonView.Owner.Equals(targetPlayer))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> rgb = (<span class="built_in">float</span>[])changedProps[PlayerColorKey];</span><br><span class="line">                _spriteRenderer.color = <span class="keyword">new</span> Color(rgb[<span class="number">0</span>], rgb[<span class="number">1</span>], rgb[<span class="number">2</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Menu"><a href="#Menu" class="headerlink" title="Menu"></a>Menu</h1><p><img src="/img/Mechanics/NetworkStructure/Menu.png"></p><p>Destroy the NetworkManager instance when returning to the menu scene to avoid some bugs.</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Menu</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Awake</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (NetworkManager.Instance())</span><br><span class="line">            Destroy(NetworkManager.Instance().gameObject);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Update</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (Input.GetKeyDown(KeyCode.Escape))</span><br><span class="line">            Application.Quit();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnOnlineButtonClicked</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        SceneManager.LoadScene(<span class="string">&quot;Lobby&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Games </category>
          
          <category> Mechanics </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Minecraft Recreation</title>
      <link href="/2026/01/01/Mechanics/Minecraft/"/>
      <url>/2026/01/01/Mechanics/Minecraft/</url>
      
        <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>A reimagining of <strong>Minecraft’s</strong> procedural world generation powered by 5-dimensional <strong>Perlin Noise</strong>.</p><p><img src="/img/Mechanics/MC.png"></p><p>The video tutorial of the <strong>Minecraft</strong> mechanic can be found <a href="">here</a> and chinese version <a href="https://www.bilibili.com/video/BV1hQhkziEq9">here</a>.</p><p>The source code is available on <a href="https://github.com/zong4/GameMechanics">GitHub</a>.</p>]]></content>
      
      
      <categories>
          
          <category> Games </category>
          
          <category> Mechanics </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Bomber, inspired by Öoo</title>
      <link href="/2026/01/01/Mechanics/Bomber/"/>
      <url>/2026/01/01/Mechanics/Bomber/</url>
      
        <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>A physics-based platformer where you <strong>are the bomb</strong> — using explosive recoil to <strong>jump</strong>, <strong>double-jump</strong>, and <strong>propel</strong> yourself through the level.</p><p><img src="/img/Mechanics/Bomber.gif"></p><p>The video tutorial of the <strong>Bomber</strong> mechanic can be found <a href="https://www.youtube.com/watch?v=5ABBmCkShY4">here</a> and chinese version <a href="https://www.bilibili.com/video/BV1qbeezcEaT">here</a>.</p><p>The source code is available on <a href="https://github.com/zong4/GameMechanics">GitHub</a>.</p>]]></content>
      
      
      <categories>
          
          <category> Games </category>
          
          <category> Mechanics </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>SuperHot Recreation</title>
      <link href="/2026/01/01/Mechanics/SuperHot/"/>
      <url>/2026/01/01/Mechanics/SuperHot/</url>
      
        <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>A Unity recreation of <strong>SuperHot’s</strong> core experience — where <strong>time only moves when you move</strong>. Rebuilt from scratch to replicate its <strong>time manipulation</strong> and <strong>combat replay</strong> mechanics, delivering the signature “time as a weapon” tactical shooter experience.</p><p><img src="/img/Mechanics/SuperHot.gif"></p><p>The video tutorial of the <strong>Super Hot</strong> mechanic can be found <a href="https://www.youtube.com/watch?v=UpLLqT7HSuo">here</a> and chinese version <a href="https://www.bilibili.com/video/BV1ndbhz7E3M/">here</a>.</p><p>The source code is available on <a href="https://github.com/zong4/GameMechanics">GitHub</a>.</p>]]></content>
      
      
      <categories>
          
          <category> Games </category>
          
          <category> Mechanics </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
